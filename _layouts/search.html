---
layout: default
title: Search
---

<h1>Search</h1>
<input type="text" id="search-box" placeholder="Search posts...">
<ul id="search-results"></ul>

<script src="https://unpkg.com/lunr/lunr.js"></script>
<script>
  let idx = null;
  let posts = [];

  async function initSearch() {
    const res = await fetch('/search.json');
    posts = await res.json();

    idx = lunr(function () {
      this.ref('url');
      this.field('title');
      this.field('content');

      posts.forEach(post => this.add(post), this);
    });
  }

  function search(query) {
    const results = idx.search(query);
    const resultList = document.getElementById('search-results');
    resultList.innerHTML = '';

    if (results.length === 0) {
      resultList.innerHTML = '<li>No results found</li>';
      return;
    }

    results.forEach(result => {
      const post = posts.find(p => p.url === result.ref);
      const li = document.createElement('li');
      li.innerHTML = `<a href="${post.url}">${post.title}</a>`;
      resultList.appendChild(li);
    });
  }

  document.getElementById('search-box').addEventListener('input', e => {
    const query = e.target.value.trim();
    if (query.length > 2) search(query);
    else document.getElementById('search-results').innerHTML = '';
  });

  initSearch();
</script>
