<!DOCTYPE html>
<html lang="en">

{% include head.html %}

<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    {% include nav.html %}

    <div class="container" style="max-width: 800px; margin: 30px auto; padding: 0 15px;">
    <input type="text" id="search-box" placeholder="ðŸ” Search posts..." style="width: 100%; padding: 10px; font-size: 16px; border: 1px solid #ccc; border-radius: 5px;">
    <ul id="results" style="list-style: none; padding-left: 0; margin-top: 10px;"></ul>
    </div>

    {{ content }}

    {% include footer.html %}

    <!-- Search results -->
    <ul id="results"></ul>

    <!-- Include Lunr.js -->
    <script src="https://unpkg.com/lunr/lunr.js"></script>

    <script>
    fetch('{{ "/search.json" | relative_url }}')
    .then(response => response.json())
    .then(posts => {
        const idx = lunr(function () {
        this.ref('url')
        this.field('title')
        this.field('content')

        posts.forEach(post => this.add(post))
        })

        document.getElementById('search-box').addEventListener('input', function () {
        const query = this.value
        const results = idx.search(query)
        const resultList = document.getElementById('results')
        resultList.innerHTML = ''

        results.forEach(result => {
            const post = posts.find(p => p.url === result.ref)
            const li = document.createElement('li')
            li.innerHTML = `<a href="${post.url}">${post.title}</a>`
            resultList.appendChild(li)
        })
        })
    })
    </script>


<!-- Image to hack wechat -->
<img src="/image/apple-touch-icon.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
